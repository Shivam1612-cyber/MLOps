2025-01-23 15:12:40,560 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-01-23 15:12:46,753 - root - INFO - Starting the training pipeline.
2025-01-23 15:12:46,753 - root - INFO - Enter the data ingestion method or component!
2025-01-23 15:12:46,909 - root - INFO - Read the dataset as dataframe!
2025-01-23 15:12:46,925 - root - INFO - Train Test Split Initiated!
2025-01-23 15:12:46,941 - root - INFO - Ingestion of data is completed!
2025-01-23 15:12:46,941 - root - INFO - Data ingestion completed. Train data path: artifacts\train.csv, Test data path: artifacts\test.csv
2025-01-23 15:12:46,972 - root - INFO - Read train and test data completed
2025-01-23 15:12:46,972 - root - INFO - Obtaining preprocessing object
2025-01-23 15:12:46,972 - root - INFO - Categorical columns: ['gender', 'race_ethnicity', 'parental_level_of_education', 'lunch', 'test_preparation_course']
2025-01-23 15:12:46,972 - root - INFO - Numerical columns: ['writing_score', 'reading_score']
2025-01-23 15:12:46,988 - root - INFO - Applying preprocessing object on training dataframe and testing dataframe.
2025-01-23 15:12:47,019 - root - INFO - Saved preprocessing object.
2025-01-23 15:12:47,019 - root - INFO - Data transformation completed.
2025-01-23 15:12:51,189 - urllib3.connectionpool - WARNING - Retrying (Retry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A174E090>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance
2025-01-23 15:12:59,297 - urllib3.connectionpool - WARNING - Retrying (Retry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB4A70>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance
2025-01-23 15:13:12,206 - urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB4D40>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance
2025-01-23 15:13:32,890 - urllib3.connectionpool - WARNING - Retrying (Retry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB4EC0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance
2025-01-23 15:14:09,080 - urllib3.connectionpool - WARNING - Retrying (Retry(total=0, connect=0, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB5040>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance
2025-01-23 15:14:13,110 - root - ERROR - Error occurred in the training pipeline.
Traceback (most recent call last):
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connection.py", line 196, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connectionpool.py", line 495, in _make_request
    conn.request(
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connection.py", line 398, in request
    self.endheaders()
  File "C:\Users\prakhar\anaconda\Lib\http\client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Users\prakhar\anaconda\Lib\http\client.py", line 1091, in _send_output
    self.send(msg)
  File "C:\Users\prakhar\anaconda\Lib\http\client.py", line 1035, in send
    self.connect()
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connection.py", line 236, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connection.py", line 211, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000001E2A2DB5340>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\prakhar\anaconda\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connectionpool.py", line 873, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connectionpool.py", line 873, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connectionpool.py", line 873, in urlopen
    return self.urlopen(
           ^^^^^^^^^^^^^
  [Previous line repeated 2 more times]
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB5340>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\utils\rest_utils.py", line 189, in http_request
    return _get_http_response_with_retries(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\utils\request_utils.py", line 237, in _get_http_response_with_retries
    return session.request(method, url, allow_redirects=allow_redirects, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB5340>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "e:\praxis-learning\mlproject\src\components\model_trainer.py", line 36, in initiate_model_trainer
    mlflow.set_experiment("student_performance")
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\tracking\fluent.py", line 157, in set_experiment
    experiment = client.get_experiment_by_name(experiment_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\tracking\client.py", line 1256, in get_experiment_by_name
    return self._tracking_client.get_experiment_by_name(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\tracking\_tracking_service\client.py", line 502, in get_experiment_by_name
    return self.store.get_experiment_by_name(name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\store\tracking\rest_store.py", line 522, in get_experiment_by_name
    response_proto = self._call_endpoint(GetExperimentByName, req_body)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\store\tracking\rest_store.py", line 82, in _call_endpoint
    return call_endpoint(self.get_host_creds(), endpoint, method, json_body, response_proto)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\utils\rest_utils.py", line 365, in call_endpoint
    response = http_request(**call_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\prakhar\anaconda\Lib\site-packages\mlflow\utils\rest_utils.py", line 212, in http_request
    raise MlflowException(f"API request to {url} failed with exception {e}")
mlflow.exceptions.MlflowException: API request to http://localhost:5001/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB5340>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Praxis-Learning\mlproject\src\pipeline\train_pipeline.py", line 22, in train_pipeline
    best_model_name, r2_square = model_trainer.initiate_model_trainer(train_array, test_array)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "e:\praxis-learning\mlproject\src\components\model_trainer.py", line 138, in initiate_model_trainer
    raise CustomException(e, sys)
src.exception.CustomException: Error occurred in python script name [e:\praxis-learning\mlproject\src\components\model_trainer.py] line number [36] error message [API request to http://localhost:5001/api/2.0/mlflow/experiments/get-by-name failed with exception HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/2.0/mlflow/experiments/get-by-name?experiment_name=student_performance (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001E2A2DB5340>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))]
